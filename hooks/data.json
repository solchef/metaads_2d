import { useRef, useEffect, useState
} from 'react'
import Grid,
{ GridCell
} from './grid'

const canvasWidth = 1800
const canvasHeight = 1800

const AdCanvas = () => {
  const canvasRef = useRef<HTMLCanvasElement>()

  function createCanvas(width: number, height: number): HTMLCanvasElement {
    canvasRef.current.width = width
    canvasRef.current.height = height
    return canvasRef.current
    }

  useEffect(() => {
    const canvasRef: HTMLCanvasElement = createCanvas(1000,
        1000)
    const g = new Grid(10000,
        40, canvasRef)
    g.onCellClick = (e, m) => {
      console.log(e.row, e.col)
      if (m.altKey) {
        g.set(
          e.row,
          e.col,
                { ...e, fillColor: 'rgba(255,
                    0,
                    0,
                    0.5)', isPassable: false
                },
                true
        )
            } else {
        g.set(
          e.row,
          e.col,
                { ...e, fillColor: 'rgba(0,
                    0,
                    0, .5)', isPassable: true
                },
                true
        )
            }
        }
    ;(window as any).g = g
    },
    [])

  return (
    <div>
      <div>
        <canvas
          ref={canvasRef
    }
          width={`${canvasWidth
        }px`
    }
          height={`${canvasHeight
        }px`
    }
        >
          Click
        </canvas>
      </div>
    </div>
  )
}

export default AdCanvas
